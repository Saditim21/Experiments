<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<view xmlns="http://jmix.io/schema/flowui/view"
      title="msg://aiChatInterfaceView.title">
    <facets>
        <dataLoadCoordinator auto="true"/>
    </facets>
    <layout>
        <vbox width="100%" height="100%" padding="true" spacing="true">
            <!-- Header -->
            <hbox width="100%" padding="true" spacing="true"
                  style="background-color: #f5f5f5; border-radius: 8px; padding: 12px;">
                <h2 text="AI Maintenance Chat" style="margin: 0; flex: 1;"/>
                <span text="Select Chat:" style="align-self: center;"/>
                <select id="chatSelect" width="250px" placeholder="Choose existing chat"/>
                <span text="Employee:" style="align-self: center;"/>
                <select id="employeeSelect" width="200px" placeholder="Select employee"/>
                <button id="newChatButton" text="New Chat" themeNames="primary"/>
            </hbox>

            <!-- Main Content -->
            <hbox width="100%" height="100%" spacing="true">
                <!-- Chat Area (70%) -->
                <vbox width="70%" height="100%" spacing="true">
                    <!-- Messages Container -->
                    <div id="messagesContainer" width="100%" height="100%"
                         style="overflow-y: auto; background-color: #fafafa; border-radius: 8px; padding: 16px; border: 1px solid #e0e0e0;"/>

                    <!-- Input Area -->
                    <vbox width="100%" spacing="true" padding="true"
                          style="background-color: #ffffff; border-radius: 8px; padding: 12px; border: 1px solid #e0e0e0;">
                        <textArea id="messageInput"
                                  placeholder="Type your message... (Press Enter to send, Shift+Enter for new line)"
                                  width="100%"
                                  height="100px"/>
                        <hbox width="100%" justifyContent="END">
                            <button id="sendButton" text="Send Message" themeNames="primary" icon="ARROW_RIGHT"/>
                        </hbox>
                    </vbox>
                </vbox>

                <!-- Context Panel (30%) -->
                <vbox width="30%" height="100%" spacing="true" padding="true"
                      style="background-color: #f5f5f5; border-radius: 8px; padding: 16px;">
                    <h4 text="Context Management" style="margin-top: 0;"/>

                    <vbox width="100%" spacing="true">
                        <span text="Available Contexts:" classNames="bold"/>
                        <select id="contextSelect" width="100%" placeholder="Select context"/>
                        <hbox width="100%" spacing="true">
                            <button id="attachContextButton" text="Attach" themeNames="primary" width="50%"/>
                            <button id="clearContextsButton" text="Clear All" themeNames="error" width="50%"/>
                        </hbox>
                    </vbox>

                    <vbox width="100%" spacing="true" style="margin-top: 16px;">
                        <span text="Attached Contexts:" classNames="bold"/>
                        <div id="attachedContextsContainer" width="100%"
                             style="min-height: 100px; background-color: white; border-radius: 4px; padding: 12px; border: 1px solid #ddd;"/>
                    </vbox>

                    <!-- Context Types Legend -->
                    <vbox width="100%" spacing="true" style="margin-top: 16px;">
                        <span text="Context Types:" classNames="bold" style="font-size: 0.9em;"/>
                        <hbox spacing="true" alignItems="CENTER">
                            <span style="width: 12px; height: 12px; background-color: #2196F3; border-radius: 50%;"/>
                            <span text="Infrastructure" style="font-size: 0.85em;"/>
                        </hbox>
                        <hbox spacing="true" alignItems="CENTER">
                            <span style="width: 12px; height: 12px; background-color: #4CAF50; border-radius: 50%;"/>
                            <span text="Maintenance History" style="font-size: 0.85em;"/>
                        </hbox>
                        <hbox spacing="true" alignItems="CENTER">
                            <span style="width: 12px; height: 12px; background-color: #FF9800; border-radius: 50%;"/>
                            <span text="Procedures" style="font-size: 0.85em;"/>
                        </hbox>
                        <hbox spacing="true" alignItems="CENTER">
                            <span style="width: 12px; height: 12px; background-color: #F44336; border-radius: 50%;"/>
                            <span text="Alerts" style="font-size: 0.85em;"/>
                        </hbox>
                    </vbox>
                </vbox>
            </hbox>
        </vbox>
    </layout>
</view>
