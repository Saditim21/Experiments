<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<view xmlns="http://jmix.io/schema/flowui/view"
      title="msg://ruleBuilderView.title">
    <facets>
        <dataLoadCoordinator auto="true"/>
    </facets>
    <layout>
        <vbox width="100%" height="100%" padding="true" spacing="true">
            <!-- Header -->
            <hbox width="100%" padding="true" spacing="true"
                  style="background-color: #f5f5f5; border-radius: 8px; padding: 12px;">
                <h2 text="Visual Rule Builder" style="margin: 0; flex: 1;"/>
                <span text="Load Rule:" style="align-self: center;"/>
                <select id="ruleSelect" width="250px" placeholder="Select existing rule"/>
                <button id="newRuleButton" text="New Rule" themeNames="primary"/>
            </hbox>

            <!-- Main Content -->
            <hbox width="100%" height="100%" spacing="true">
                <!-- Rule Configuration (40%) -->
                <vbox width="40%" height="100%" spacing="true" padding="true"
                      style="background-color: #fafafa; border-radius: 8px; padding: 16px;">
                    <h4 text="Rule Configuration" style="margin-top: 0;"/>

                    <formLayout width="100%">
                        <textField id="ruleNameField" label="Rule Name" required="true" width="100%"/>
                        <textField id="ruleCodeField" label="Rule Code" required="true" width="100%"/>
                        <select id="scenarioTypeSelect" label="Scenario Type" required="true" width="100%"/>
                        <textField id="priorityField" label="Priority (1-100)" required="true" width="100%"/>
                        <select id="createdBySelect" label="Created By" required="true" width="100%"/>
                    </formLayout>

                    <hbox width="100%" spacing="true" style="margin-top: 16px;">
                        <button id="saveRuleButton" text="Save Rule" themeNames="primary success" width="50%"/>
                        <button id="exportRuleButton" text="Export" themeNames="contrast" width="25%"/>
                        <button id="importRuleButton" text="Import" themeNames="contrast" width="25%"/>
                    </hbox>
                </vbox>

                <!-- Rule Builder (60%) -->
                <vbox width="60%" height="100%" spacing="true">
                    <!-- Conditions Section -->
                    <vbox width="100%" spacing="true" padding="true"
                          style="background-color: #E3F2FD; border-radius: 8px; padding: 16px;">
                        <hbox width="100%" justifyContent="BETWEEN" alignItems="CENTER">
                            <h4 text="Conditions (IF)" style="margin: 0; color: #2196F3;"/>
                            <button id="addConditionButton" text="+ Add Condition" themeNames="primary small"/>
                        </hbox>
                        <div id="conditionsContainer" width="100%" height="250px"
                             style="overflow-y: auto; background-color: white; border-radius: 4px; padding: 12px;"/>
                    </vbox>

                    <!-- Actions Section -->
                    <vbox width="100%" spacing="true" padding="true"
                          style="background-color: #E8F5E9; border-radius: 8px; padding: 16px;">
                        <hbox width="100%" justifyContent="BETWEEN" alignItems="CENTER">
                            <h4 text="Actions (THEN)" style="margin: 0; color: #4CAF50;"/>
                            <button id="addActionButton" text="+ Add Action" themeNames="success small"/>
                        </hbox>
                        <div id="actionsContainer" width="100%" height="250px"
                             style="overflow-y: auto; background-color: white; border-radius: 4px; padding: 12px;"/>
                    </vbox>

                    <!-- Test Section -->
                    <vbox width="100%" spacing="true" padding="true"
                          style="background-color: #FFF3E0; border-radius: 8px; padding: 16px;">
                        <h4 text="Rule Testing" style="margin: 0; color: #F57C00;"/>
                        <textArea id="testInputArea"
                                  placeholder="Enter test input data (JSON format)"
                                  width="100%"
                                  height="100px"/>
                        <hbox width="100%" justifyContent="BETWEEN">
                            <button id="testRuleButton" text="â–¶ Test Rule" themeNames="primary"/>
                            <button id="clearTestButton" text="Clear" themeNames="tertiary"/>
                        </hbox>
                        <div id="testResultsContainer" width="100%"
                             style="min-height: 60px; background-color: white; border-radius: 4px; padding: 12px;"/>
                    </vbox>
                </vbox>
            </hbox>
        </vbox>
    </layout>
</view>
