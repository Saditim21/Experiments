<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<view xmlns="http://jmix.io/schema/flowui/view"
      title="msg://tacticalPlanGanttView.title">
    <data>
        <collection id="tacticalPlanDc"
                    class="com.company.experiments.entity.TacticalPlan">
            <fetchPlan extends="_base">
                <property name="planningScenario" fetchPlan="_instance_name"/>
                <property name="maintenanceScenario" fetchPlan="_instance_name">
                    <property name="infrastructureNode" fetchPlan="_instance_name"/>
                </property>
                <property name="assignedTeam" fetchPlan="_instance_name"/>
                <property name="assignedEmployees" fetchPlan="_instance_name"/>
            </fetchPlan>
            <loader id="tacticalPlanDl" readOnly="true">
                <query>
                    <![CDATA[select e from TacticalPlan e
                             where e.plannedStartDate is not null
                             and e.plannedEndDate is not null
                             order by e.plannedStartDate]]>
                </query>
            </loader>
        </collection>
    </data>
    <facets>
        <dataLoadCoordinator auto="true"/>
    </facets>
    <layout>
        <vbox width="100%" height="100%" padding="true" spacing="true">
            <hbox width="100%" classNames="buttons-panel">
                <button id="backButton" text="Back to List" icon="ARROW_LEFT"/>
                <button id="refreshButton" text="Refresh" icon="REFRESH"/>
                <select id="filterByStatusSelect" label="Filter by Status" itemsEnum="com.company.experiments.entity.TacticalPlanStatus"/>
                <entityPicker id="filterByScenarioField" label="Filter by Scenario" metaClass="YearlyBudgetPlanningScenario">
                    <actions>
                        <action id="entityLookup" type="entity_lookup"/>
                        <action id="entityClear" type="entity_clear"/>
                    </actions>
                </entityPicker>
            </hbox>

            <div id="ganttChartHtml" width="100%" height="600px"/>

            <details summaryText="Resource Allocation" opened="true">
                <vbox width="100%" spacing="true">
                    <h3 text="Resource Allocation by Team"/>
                    <div id="resourceAllocationChartHtml" width="100%" height="400px"/>

                    <h3 text="Budget Allocation Overview"/>
                    <dataGrid id="budgetSummaryGrid"
                              width="100%"
                              minHeight="15em"
                              dataContainer="tacticalPlanDc">
                        <columns resizable="true">
                            <column property="planName"/>
                            <column property="assignedTeam"/>
                            <column property="budgetAllocated"/>
                            <column property="status"/>
                            <column property="plannedStartDate"/>
                            <column property="plannedEndDate"/>
                        </columns>
                    </dataGrid>
                </vbox>
            </details>
        </vbox>
    </layout>
</view>
